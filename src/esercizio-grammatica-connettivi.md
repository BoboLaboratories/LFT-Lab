---
geometry: "a4paper, left=1.5cm, right=1.5cm, top=2cm, bottom=2cm"
numbersections: true
---

\tableofcontents


\vfill

\pagebreak


# Esercizio 5.2

## Grammatica modificata per inserire i connettivi logici

Si aggiungono le produzioni per $\langle bexpr \rangle$ denotate da $\star$.

+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle prog \rangle \rightarrow \langle statlist \rangle$ `EOF`                                                                                              |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle statlist \rangle \rightarrow \langle stat \rangle \langle statlistp \rangle$                                                                          |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle statlistp \rangle \rightarrow$ `;` $\langle stat \rangle \langle statlistp \rangle$                                                                   |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle statlistp \rangle \rightarrow \varepsilon$                                                                                                            |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle stat \rangle \rightarrow$ `assign` $\langle assignlist \rangle$                                                                                       |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle stat \rangle \rightarrow$ `print` `(` $\langle exprlist \rangle$ `)`                                                                                  |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle stat \rangle \rightarrow$ `read` `(` $\langle idlist \rangle$ `)`                                                                                     |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle stat \rangle \rightarrow$ `for` `(` $\langle statc \rangle$ $\langle bexpr \rangle$ `)` `do` $\langle stat \rangle$                                   |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle stat \rangle \rightarrow$ `if` `(` $\langle bexpr \rangle$ `)` $\langle stat \rangle \langle statp \rangle$ `end`                                     |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle stat \rangle \rightarrow$ `{` $\langle statlist \rangle$ `}`                                                                                          |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle statc \rangle \rightarrow$ `ID` `:=` $\langle expr \rangle$ `;`                                                                                       |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle statc \rangle \rightarrow \varepsilon$                                                                                                                |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle statp \rangle \rightarrow$ `else` $\langle stat \rangle$                                                                                              |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle statp \rangle \rightarrow \varepsilon$                                                                                                                |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle assignlist \rangle \rightarrow$ `[` $\langle expr \rangle$ `to` $\langle idlist \rangle$ `]` $\langle assignlistp \rangle$                            |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle assignlistp \rangle \rightarrow$ `[` $\langle expr \rangle$ `to` $\langle idlist \rangle$ `]` $\langle assignlistp \rangle$                           |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle assignlistp \rangle \rightarrow \varepsilon$                                                                                                          |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle idlist \rangle \rightarrow$ `ID` $\langle idlistp \rangle$                                                                                            |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle idlistp \rangle \rightarrow$ `,` `ID` $\langle idlistp \rangle$                                                                                       |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle idlistp \rangle \rightarrow \varepsilon$                                                                                                              |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle bexpr \rangle \rightarrow$ `<` $\langle expr \rangle \langle expr \rangle$                                                                            |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle bexpr \rangle \rightarrow$ `>` $\langle expr \rangle \langle expr \rangle$                                                                            |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle bexpr \rangle \rightarrow$ `<=` $\langle expr \rangle \langle expr \rangle$                                                                           |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle bexpr \rangle \rightarrow$ `<=` $\langle expr \rangle \langle expr \rangle$                                                                           |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle bexpr \rangle \rightarrow$ `==` $\langle expr \rangle \langle expr \rangle$                                                                           |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle bexpr \rangle \rightarrow$ `<>` $\langle expr \rangle \langle expr \rangle$                                                                           |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
| $\star$ | $\langle bexpr \rangle \rightarrow$ `&&` $\langle bexpr \rangle \langle bexpr \rangle$                                                                         |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
| $\star$ | $\langle bexpr \rangle \rightarrow$ `||` $\langle bexpr \rangle \langle bexpr \rangle$                                                                         |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
| $\star$ | $\langle bexpr \rangle \rightarrow$ `!` $\langle bexpr \rangle$                                                                                                |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle expr \rangle \rightarrow$ `+` `(` $\langle exprlist \rangle$ `)`                                                                                      |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle expr \rangle \rightarrow$ `-` $\langle expr \rangle \langle expr \rangle$                                                                             |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle expr \rangle \rightarrow$ `*` `(` $\langle exprlist \rangle$ `)`                                                                                      |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle expr \rangle \rightarrow$ `/` $\langle expr \rangle \langle expr \rangle$                                                                             |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle expr \rangle \rightarrow$ `NUM`                                                                                                                       |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle expr \rangle \rightarrow$ `ID`                                                                                                                        |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle exprlist \rangle \rightarrow \langle expr \rangle \langle exprlistp \rangle$                                                                          |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle exprlistp \rangle \rightarrow$ `,` $\langle expr \rangle \langle exprlistp \rangle$                                                                   |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
|         | $\langle exprlistp \rangle \rightarrow \varepsilon$                                                                                                            |
+---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+

\pagebreak

## Calcolo di NULL, FIRST e FOLLOW

+-------------------------------+------------------+----------------------------------------------------------------------------------------+-------------------------------------------------------------------+
|                               | \center{NULL}    | FIRST                                                                                  | FOLLOW                                                            |
+===============================+==================+========================================================================================+===================================================================+
| $\langle$prog$\rangle$        |                  | { `assign`, `print`, `read`, `for`, `if`, `{` }                                        | { `$` }                                                           |
+-------------------------------+------------------+----------------------------------------------------------------------------------------+-------------------------------------------------------------------+
| $\langle$statlist$\rangle$    |                  | { `assign`, `print`, `read`, `for`, `if`, `{` }                                        | { `EOF`, `}` }                                                    |
+-------------------------------+------------------+----------------------------------------------------------------------------------------+-------------------------------------------------------------------+
| $\langle$statlistp$\rangle$   | \center{x}       | { `;` }                                                                                | { `EOF`, `}` }                                                    |
+-------------------------------+------------------+----------------------------------------------------------------------------------------+-------------------------------------------------------------------+
| $\langle$stat$\rangle$        |                  | { `assign`, `print`, `read`, `for`, `if`, `{` }                                        | { `;`, `else`, `end`, `EOF`, `}` }                                |
+-------------------------------+------------------+----------------------------------------------------------------------------------------+-------------------------------------------------------------------+
| $\langle$statc$\rangle$       | \center{x}       | { `ID` }                                                                               | { `<`, `>`, `<=`, `>=`, `==`, `<>`, `&&`, `||`, `!` }             |
+-------------------------------+------------------+----------------------------------------------------------------------------------------+-------------------------------------------------------------------+
| $\langle$statp$\rangle$       | \center{x}       | { `else` }                                                                             | { `end` }                                                         |
+-------------------------------+------------------+----------------------------------------------------------------------------------------+-------------------------------------------------------------------+
| $\langle$assignlist$\rangle$  |                  | { `[` }                                                                                | { `;`, `else`, `end`, `EOF`, `}` }                                |
+-------------------------------+------------------+----------------------------------------------------------------------------------------+-------------------------------------------------------------------+
| $\langle$assignlistp$\rangle$ | \center{x}       | { `[` }                                                                                | { `;`, `else`, `end`, `EOF`, `}` }                                |
+-------------------------------+------------------+----------------------------------------------------------------------------------------+-------------------------------------------------------------------+
| $\langle$idlist$\rangle$      |                  | { `ID` }                                                                               | { `)`, `]` }                                                      |
+-------------------------------+------------------+----------------------------------------------------------------------------------------+-------------------------------------------------------------------+
| $\langle$idlistp$\rangle$     | \center{x}       | { `,` }                                                                                | { `)`, `]` }                                                      |
+-------------------------------+------------------+----------------------------------------------------------------------------------------+-------------------------------------------------------------------+
| $\langle$bexpr$\rangle$       |                  | { `<`, `>`, `<=`, `>=`, `==`, `<>`, `&&`, `||`, `!` }                                  | { `)` }                                                           |
+-------------------------------+------------------+----------------------------------------------------------------------------------------+-------------------------------------------------------------------+
| $\langle$expr$\rangle$        |                  | { `+`, `-`, `*`, `/`, `NUM`, `ID` }                                                    | { `,`, `;`, `to`, `+`, `-`, `*`, `/`, `)`, `NUM`, `ID` }          |
+-------------------------------+------------------+----------------------------------------------------------------------------------------+-------------------------------------------------------------------+
| $\langle$exprlist$\rangle$    |                  | { `+`, `-`, `*`, `/`, `NUM`, `ID` }                                                    | { `)` }                                                           |
+-------------------------------+------------------+----------------------------------------------------------------------------------------+-------------------------------------------------------------------+
| $\langle$exprlistp$\rangle$   | \center{x}       | { `,` }                                                                                | { `)` }                                                           |
+-------------------------------+------------------+----------------------------------------------------------------------------------------+-------------------------------------------------------------------+

## Calcolo degli insiemi GUIDA

+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle prog \rangle \rightarrow \langle statlist \rangle$ `EOF`)                                                                                             | { `assign`, `print`, `read`, `for`, `if`, `{` }                           |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle statlist \rangle \rightarrow \langle stat \rangle \langle statlistp \rangle)$                                                                         | { `assign`, `print`, `read`, `for`, `if`, `{` }                           |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle statlistp \rangle \rightarrow$ `;` $\langle stat \rangle \langle statlistp \rangle)$                                                                  | { `;` }                                                                   |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle statlistp \rangle \rightarrow \varepsilon)$                                                                                                           | { `EOF`, `}` }                                                            |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle stat \rangle \rightarrow$ `assign` $\langle assignlist \rangle)$                                                                                      | { `assign` }                                                              |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle stat \rangle \rightarrow$ `print` `(` $\langle exprlist \rangle$ `)` )                                                                                | { `print` }                                                               |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle stat \rangle \rightarrow$ `read` `(` $\langle idlist \rangle$ `)` )                                                                                   | { `read` }                                                                |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle stat \rangle \rightarrow$ `for` `(` $\langle statc \rangle$ $\langle bexpr \rangle$ `)` `do` $\langle stat \rangle$)                                  | { `for` }                                                                 |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle stat \rangle \rightarrow$ `if` `(` $\langle bexpr \rangle$ `)` $\langle stat \rangle \langle statp \rangle$ `end`)                                    | { `if` }                                                                  |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle stat \rangle \rightarrow$ `{` $\langle statlist \rangle$ `}`)                                                                                         | { `{` }                                                                   |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle statc \rangle \rightarrow$ `ID` `:=` $\langle expr \rangle$ `;`)                                                                                      | { `ID` }                                                                  |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle statc \rangle \rightarrow \varepsilon$                                                                                                                | { `<`, `>`, `<=`, `>=`, `==`, `<>`, `&&`, `||`, `!` }                     |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle statp \rangle \rightarrow$ `else` $\langle stat \rangle$)                                                                                             | { `else` }                                                                |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle statp \rangle \rightarrow \varepsilon$)                                                                                                               | { `end` }                                                                 |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle assignlist \rangle \rightarrow$ `[` $\langle expr \rangle$ `to` $\langle idlist \rangle$ `]` $\langle assignlistp \rangle$)                           | { `[` }                                                                   |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle assignlistp \rangle \rightarrow$ `[` $\langle expr \rangle$ `to` $\langle idlist \rangle$ `]` $\langle assignlistp \rangle$)                          | { `[` }                                                                   |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle assignlistp \rangle \rightarrow \varepsilon)$                                                                                                         | { `;`, `else`, `end`, `EOF`, `}` }                                        |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle idlist \rangle \rightarrow$ `ID` $\langle idlistp \rangle)$                                                                                           | { `ID` }                                                                  |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle idlistp \rangle \rightarrow$ `,` `ID` $\langle idlistp \rangle)$                                                                                      |  { `,` }                                                                  |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle idlistp \rangle \rightarrow \varepsilon)$                                                                                                             | { `)`, `]` }                                                              |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle bexpr \rangle \rightarrow$ `<` $\langle expr \rangle \langle expr \rangle)$                                                                           | { `<` }                                                                   |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle bexpr \rangle \rightarrow$ `>` $\langle expr \rangle \langle expr \rangle)$                                                                           | { `>` }                                                                   |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle bexpr \rangle \rightarrow$ `<=` $\langle expr \rangle \langle expr \rangle)$                                                                          | { `<=` }                                                                  |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle bexpr \rangle \rightarrow$ `<=` $\langle expr \rangle \langle expr \rangle)$                                                                          | { `<=` }                                                                  |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle bexpr \rangle \rightarrow$ `==` $\langle expr \rangle \langle expr \rangle)$                                                                          | { `==` }                                                                  |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle bexpr \rangle \rightarrow$ `<>` $\langle expr \rangle \langle expr \rangle)$                                                                          | { `<>` }                                                                  |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle bexpr \rangle \rightarrow$ `&&` $\langle bexpr \rangle \langle bexpr \rangle)$                                                                        | { `&&` }                                                                  |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle bexpr \rangle \rightarrow$ `||` $\langle bexpr \rangle \langle bexpr \rangle)$                                                                        | { `||` }                                                                  |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle bexpr \rangle \rightarrow$ `!` $\langle bexpr \rangle)$                                                                                               | { `!` }                                                                   |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle expr \rangle \rightarrow$ `+` `(` $\langle exprlist \rangle$ `)`)                                                                                     | { `+` }                                                                   |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle expr \rangle \rightarrow$ `-` $\langle expr \rangle \langle expr \rangle)$                                                                            | { `-` }                                                                   |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle expr \rangle \rightarrow$ `*` `(` $\langle exprlist \rangle$ `)`)                                                                                     | { `*` }                                                                   |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle expr \rangle \rightarrow$ `/` $\langle expr \rangle \langle expr \rangle)$                                                                            | { `/` }                                                                   |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle expr \rangle \rightarrow$ `NUM`)                                                                                                                      | { `NUM` }                                                                 |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle expr \rangle \rightarrow$ `ID`)                                                                                                                       | { `ID` }                                                                  |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle exprlist \rangle \rightarrow \langle expr \rangle \langle exprlistp \rangle)$                                                                         | { `+`, `-`, `*`, `/`, `NUM`, `ID` }                                       |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle exprlistp \rangle \rightarrow$ `,` $\langle expr \rangle \langle exprlistp \rangle)$                                                                  | { `,` }                                                                   |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+
| GUIDA$(\langle exprlistp \rangle \rightarrow \varepsilon)$                                                                                                           | { `)` }                                                                   |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------+